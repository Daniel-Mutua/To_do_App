<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸŒŸ TaskMaster Legit</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #FFD700;
    --bg-dark: #1a1a1a;
    --card: #222222;
    --text-light: #f5f5f5;
    --text-muted: #a0a0a0;
    --success: #22c55e;
    --danger: #ef4444;
  }

  body, html {
    margin:0; padding:0; width:100%; height:100%;
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg,#0d0d0d,#1a1a1a);
    color: var(--text-light);
    display:flex; justify-content:center; align-items:center;
  }

  .container {
    width:95%; max-width:1000px; height:90%;
    background: var(--card); border-radius:24px;
    padding:30px 40px; display:flex; flex-direction:column;
    box-shadow:0 20px 50px rgba(0,0,0,0.6);
  }

  h1 {text-align:center; font-size:3rem; font-weight:800; margin-bottom:25px;
      background: linear-gradient(90deg, var(--primary), #e6c200);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;}

  .stats-container {display:grid; grid-template-columns:repeat(3,1fr); gap:20px; margin-bottom:20px;}
  .stat-card {background:#2a2a2a; padding:20px; border-radius:12px; text-align:center; border:1px solid #444;}
  .stat-card span{display:block;font-size:.85rem;color:var(--text-muted);text-transform:uppercase;}
  .stat-card strong{font-size:1.7rem;color:var(--primary);}

  .input-group {display:flex; gap:10px; margin-bottom:20px;}
  input {flex:1; padding:16px 20px; border-radius:12px; border:2px solid #444; background:#111; color:var(--text-light); font-size:18px;}
  input:focus {border-color: var(--primary); outline:none; box-shadow:0 0 15px rgba(255,215,0,0.4);}
  .add-btn, .view-btn {background: var(--primary); color:#111; border:none; padding:0 28px; border-radius:12px; font-weight:700; cursor:pointer; font-size:16px;}
  .add-btn:hover, .view-btn:hover {background:#e6c200; transform:translateY(-2px);}

  .task-sections {display:flex; flex:1; gap:20px; overflow:hidden;}
  .task-section {flex:1; background:#2a2a2a; border-radius:20px; padding:20px; display:flex; flex-direction:column; overflow-y:auto;}
  .task-section h2 {font-size:1.5rem; font-weight:700; color: var(--primary); margin-bottom:15px; text-align:center;}

  ul {list-style:none; padding:0; margin:0; flex-grow:1;}
  li {display:flex; justify-content:space-between; align-items:center; background:#1f1f1f; padding:16px 20px; margin-bottom:12px; border-radius:16px; border:1px solid #444; transition:all 0.3s ease; cursor:pointer;}
  li:hover {border-color: var(--primary); box-shadow:0 5px 15px rgba(255,215,0,0.3);}
  .task-title {font-weight:600; font-size:1.1rem;}
  .completed .task-title {text-decoration:line-through; color:var(--text-muted);}
  .actions button {padding:6px 12px; border-radius:8px; border:none; font-weight:600; cursor:pointer; transition:all 0.2s;}
  .delete-btn {background: var(--danger); color:#fff;}
  .delete-btn:hover {background:#ff5555;}
  .badge {display:inline-block; padding:2px 8px; border-radius:6px; font-size:.7em; font-weight:700; text-transform:uppercase; margin-left:8px;}
  .badge-pending {background:#444; color:var(--primary);}
  .badge-completed {background:var(--success); color:#111;}
  .empty-state {text-align:center; padding:20px; color:var(--text-muted);}
  .clear-completed {margin-top:15px; background:#333; color:var(--primary); border:1px solid #555; padding:12px; border-radius:12px; cursor:pointer; font-weight:600; transition:all 0.2s; width:100%;}
  .clear-completed:hover {background:#555;}
  .timestamp {font-size:.7rem; color:var(--text-muted); margin-top:4px;}
</style>
</head>
<body>
<div class="container">
  <h1>ðŸŒŸ TaskMaster Gold</h1>

  <div class="stats-container">
    <div class="stat-card"><span>Total</span><strong id="total-count">0</strong></div>
    <div class="stat-card"><span>Pending</span><strong id="pending-count">0</strong></div>
    <div class="stat-card"><span>Done</span><strong id="completed-count">0</strong></div>
  </div>

  <div class="input-group">
    <input type="text" id="taskInput" placeholder="Add a new task">
    <button class="add-btn" onclick="addTask()">Add</button>
    <button class="view-btn" onclick="fetchTasks()">View Tasks</button>
  </div>

  <div class="task-sections">
    <div class="task-section">
      <h2>Pending Tasks</h2>
      <ul id="pendingTasks"></ul>
      <div class="empty-state" id="emptyPending">No pending tasks yet!</div>
    </div>
    <div class="task-section">
      <h2>Completed Tasks</h2>
      <ul id="completedTasks"></ul>
      <div class="empty-state" id="emptyCompleted">No completed tasks yet!</div>
    </div>
  </div>

  <button class="clear-completed" onclick="clearCompleted()">Clear Completed Tasks</button>
</div>

<script>
const apiUrl = "http://localhost:5000/api/tasks";

async function fetchTasks(){
  try{
    const res = await fetch(apiUrl);
    if(!res.ok) throw new Error("Failed to fetch tasks");
    const tasks = await res.json();
    renderTasks(tasks);
    updateStats(tasks);
  }catch(err){ console.error(err);}
}

function renderTasks(tasks){
  const pendingList = document.getElementById('pendingTasks');
  const completedList = document.getElementById('completedTasks');
  const emptyPending = document.getElementById('emptyPending');
  const emptyCompleted = document.getElementById('emptyCompleted');

  pendingList.innerHTML='';
  completedList.innerHTML='';

  const pendingTasks = tasks.filter(t => !t.completed);
  const completedTasks = tasks.filter(t => t.completed);

  emptyPending.style.display = pendingTasks.length===0?'block':'none';
  emptyCompleted.style.display = completedTasks.length===0?'block':'none';

  pendingTasks.forEach(t=>{
    const li = document.createElement('li');
    li.innerHTML=`
      <div onclick="toggleTask('${t._id}')" class="task-content">
        <span class="task-title">${t.title}</span>
        <span class="timestamp">${new Date(t.createdAt||Date.now()).toLocaleString()}</span>
      </div>
      <div class="actions">
        <button class="delete-btn" onclick="deleteTask('${t._id}', event)">Delete</button>
        <span class="badge badge-pending">Pending</span>
      </div>
    `;
    pendingList.appendChild(li);
  });

  completedTasks.forEach(t=>{
    const li = document.createElement('li');
    li.className='completed';
    li.innerHTML=`
      <div onclick="toggleTask('${t._id}')" class="task-content">
        <span class="task-title">${t.title}</span>
        <span class="timestamp">${new Date(t.createdAt||Date.now()).toLocaleString()}</span>
      </div>
      <div class="actions">
        <button class="delete-btn" onclick="deleteTask('${t._id}', event)">Delete</button>
        <span class="badge badge-completed">Done</span>
      </div>
    `;
    completedList.appendChild(li);
  });
}

function updateStats(tasks){
  const total = tasks.length;
  const completed = tasks.filter(t=>t.completed).length;
  const pending = total-completed;
  document.getElementById('total-count').innerText=total;
  document.getElementById('completed-count').innerText=completed;
  document.getElementById('pending-count').innerText=pending;
}

async function addTask(){
  const input = document.getElementById('taskInput');
  const title=input.value.trim();
  if(!title) return alert("Enter a task!");
  await fetch(apiUrl,{method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({title})});
  input.value='';
  fetchTasks();
}

async function deleteTask(id,e){
  e.stopPropagation();
  await fetch(`${apiUrl}/${id}`,{method:'DELETE'});
  fetchTasks();
}

async function toggleTask(id){
  await fetch(`${apiUrl}/${id}`,{method:'PUT'});
  fetchTasks();
}

async function clearCompleted(){
  const res = await fetch(apiUrl);
  const tasks = await res.json();
  tasks.filter(t=>t.completed).forEach(t=>{
    fetch(`${apiUrl}/${t._id}`,{method:'DELETE'});
  });
  fetchTasks();
}

// fetch tasks immediately when page loads
fetchTasks();
</script>
</body>
</html>

